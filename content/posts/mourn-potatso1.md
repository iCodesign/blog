---
title: "祭奠死去的 Potatso 1"
date: 2017-04-23T17:11:54+08:00
---

## 🐣 起步

让我们把时钟拨回到 2015 年 WWDC，Apple 在那时发布了 Network Extension 框架。这个 iOS 史上最为开放的 API 可以说瞬间吸引了我的注意，它背后强大的能力让你无法忽视。

但由于当时工作上的事情比较忙（阿里巴巴，你懂的 😂），我并没有立即投入到相关研究中去，而是直到当年 9 月底才正式开始在业余时间断断续续尝试搭建 Potatso 1。早期的用户可能知道，这款 App 直到次年 1 月 15 日才正式上架 App Store，且再过了两个月才启用了网络工具功能。Potatso 1 完全由我一人开发，从产品、设计到iOS、后段开发，再到客服、运营，全部包干。没错，我就是传说中的『全干』工程师。

当然，这么长时间的开发也是有原因的，我总结为两点：有限的时间投入以及技术上的障碍。

## ⏱ 有限的时间投入

我不是富二代，亦没有创业成功，所以在这过程中我依旧需要保持着一份稳定的工作。

我参与过小团队创业，也在大公司工作过，虽然我也会时不时骂一两句公司，但是我依旧怀着感恩的心情对待这两家公司，一个给了我从 0 到 1 的机会，一个给了我更大的视野。

众所周知，很多国内互联网公司保持着一个畸形的作息时间。我每周投入到 Potatso 1 开发中的时间很有限，平均下来密集开发可能也就两三个小时，很多时候晚上也就能翻翻各种文档，抓抓包。

## 🚧 技术障碍

除了有限的时间，更大的问题还是在技术上：

### 文档稀缺

Apple 放出这个 Extension 之后，并没有给出任何的教程和文档，只给出了一个简单的 Demo。当时 Network Extension 也需要向 Apple 申请才能使用，Xcode Extension 的模版需要手动下载安装。

直到今天，官方其实也是没有一份完善的文档的，好在函数注释多了不少，能帮助我们更好的了解这个框架，聊胜于无，对吧 🌚。

早期研究这个框架的人很少，我最早注意到的是 @clowwindy 在 ShadowVPN 项目中的使用。值得说明的是，我早期在官方开发者论坛以及通过 ATS（Apple Technical Support）获得了不少帮助。ATS 确实很有用，然而一年只有两次（什么？还想咨询？再交 99$）。

### 个人技术有限

Network Extension 的开发需要大量的网络相关知识，然而我本人主要是做上层应用开发，对相关的知识了解并不是很深入，因此在实现 Potatso 1 乃至 Potatso 2 的过程中绕了很多弯，推倒重建了数次，花费了大量时间。

这也导致：为了走一些捷径，在这过程中，我在一些关键部分使用了开源组件。具体的技术细节我将在后续的文章中说明。

当然，作为一名合格的程序员，没学过、不会并不是能阻挡前进的理由。开发 Potatso 的过程我愿意用『痛并快乐着』来形容。痛在你需要面对大量新的知识，面对枯燥的二进制报文，快乐在享受解决一个个未知的问题所带来的成就感。

### 技术难点

实现一个全功能的代理软件包含的技术点非常多，从底层 TCP/IP 栈到上层各种代理的实现，从 Network Extension API 的摸索到 iOS App 的编写，每一样都不是一件很简单的事，很多的知识点都是边学边做，甚至是读 RFC 文档。

我不能说它的实现非常难，因为至少它在现有的知识系统里是可解的，但对于大部分人来说可能也不是一件轻松的事，尤其是刚接触这个领域的人，至少一开始对我来说………

## 🌓 开源

很多人可能知道去年我开源了 Potatso 的完整版本，也获得了开源社区的关注和肯定，登上了当日 GitHub trending 的榜首。

现在来看，这很难说是一个正确的决定。很多人一看，『哟，完整的 app，还能挣钱，他卖 45，我卖 6 块好了』。于是，大量的 Potatso copy 开始上架。这也就算了，我开源前就已经想到了。但是真正让我看到人性恶的一面是：作为有能力编译Potatso及上架的人，我理解至少是一个接受过良好教育的人，很多上架的人连名字都不改，Today Widget 的名字还是Potatso，点击连接唤起了 Potatso，甚至直接使用我服务器的 API。

在开源的 Potatso 1 中，我提供了一套基本的 iOS 自定义代理方案，然而遗憾的是，并没有人在真正的用其原理去做更多的事。受限于本身付费软件的属性，Potatso 并没有形成开源软件应有的社区氛围，当然这一点应该是我的责任，因为这仍旧是一个敏感的领域。我有一些顾虑，无法在这方面做的更多。一言以蔽之：原理我已经告诉你了，麻烦好好思考，别当 CTRL+C 和 CTRL+V 程序员了，把掉起的节操拾起来。

## ❤️ Potatso 2

在经过了长达半年的第二次开发测试之后，Potatso 2 于 2017 年 4 月 4 日 清明节上架 App Store（为了祭奠死去的 Potatso 1）。Potatso 2 是 99% 重写的，你可以理解为一个完全新的 app，在核心部分也并没有使用任何开源库。在 Potatso 2 的设计之初就考虑到了扩展性，可以很方便的集成更多代理类型（新版加入了 Socks 和 Socks over TLS 的支持）。

至于为什么又花了这么长时间，一方面是工作量比较大，一方面是自己的事情有点多（出差、休假、装修搬家等等杂事）。好在一切很快尘埃落定，我有了更多的时间花在 Potatso 2 的维护上。

### Potatso 升级问题

Potatso 1 到 Potatso 2 的升级过程引来了一些争议，在此我也一一解答一下。

> 作者明明公开承诺 Potatso 1 可以免费升级到 Potatso 2，为什么我需要补差价？

这个锅我背。我本意是愿意让 Potatso 1 的用户免费升级到 Potatso 2 的，但是还是产生了一些小插曲：

我采用的是业内流行的套装（Bundle）升级方式，即单独推出一个新的套装，包含 Potatso 1 和 Potatso 2，已拥有 Potatso 1 的用户直接购买这个套装，即可免费获取 Potatso 2。

但是我没有想到的是（第一次使用套装升级）：这个免费是有条件的。Apple 会记录你购买 Potatso 1 的价格，在购买套装上，如果之前购买价格低于套装价格，需要补差价。举个例子，如果你以 12 元价格购买 Potatso 1，而升级套装价格是 40，你则需要补全 28 的差价，而更不幸的是，如果你是用兑换码兑换的 Potatso 1，Apple 记录的购买价格是 0。这个过程我是无法控制的，对此产生的不便以及与我承诺相左的额外支出，我只能表示抱歉。（个别用户由于无法支付的原因，向我私人购买了兑换码，我也向他们赠送了 Potarso 2 的更新）

至于为什么现在升级套装是 40 的原因是：一方面你可以看到上面的价格曲线，Potatso 基本长期都是在 45 的价格，所以 40 能够满足大部分用户免费升级，另一方面，在第一周上线的时候我设置的价格为 30（与 2 的价格一致），这导致一个后果是：大部分新用户由于心理原因，会选择购买升级套装而不是 Potatso 2，而这不是我希望出现的，这算是我的定价失误）

> 那么为什么你不在 Potatso 1 上直接更新，这样就没有升级套装问题了？

这是我的另一个失误。由于在 Potatso 1 开发过程中使用第三方库不小心污染到了一些签名问题导致 Potatso 1 是无法转让给其他账户的，一个潜在的后果就是如果将来 Potatso 由于不可抗力真要下架，是无法转让的。为了留条后路，我选择了重新上架。

总之，这个升级过程的麻烦主要是我的问题导致的，当然也有 Apple 这种奇怪的套装定价策略。更合理的是，Apple 应该提供给开发者更多的选项。再次对受到影响的用户表示抱歉。

## 😇 心态

为什么要说这个？因为独立开发是一个很艰难的过程，保持一个良好的心态很重要。

每天有很多热心的用户给我反馈，还有一些邮件，有社交平台的私信，一个人是很难面面俱到的，无法做到一一回复。不然哪还有时间去写代码嘛。

这个世界很复杂，你可能会遇到各种各样的人，会有人因为你不会私信辱骂你，会有人因为你不支持某个功能辱骂你，会有人因为有 bug 辱骂你。幸好我是个乐观的人，不然哪还有心情写代码嘛。

盈利重要吗？重要。付出了很多时间，输出了很多知识，盈利是一种很直接的回报。盈利也能为你提供更强的动力，保证软件的持续开发和更新。所以别在价格上跟我纠结了，不过是一杯咖啡而已。你请我喝一杯咖啡，得到一个有趣的软件，这波你绝对不亏。（所以不要去买什么黑卡，不要去买什么家庭共享了，现在没有防盗版不代表将来不会有）

## 💪 支持我

最后，如果你愿意支持 Potatso 的未来发展，下载并使用 Potatso 2 是最简单直接的方式 。

Potatso 2 下载地址：[Potatso 2](https://download.potatso.com)
